---
title: Observer Pattern
date: 2018-03-18 13:06:32
tags: Java Code Design
---



# Design Pattern的出现意义

概念就不说了之前文章就有. 它的意义或者说作用是:

将代码设计得更好, 比如要可以**重复使用**、**容易看懂**、代码要**可靠正确**等, 达到这些要求便能真正实现工程化. 总的来说就是你要有做一名**代码艺术大师**的理想, 才能成为一合格的工程师.

<u>言而总之: 设计模式即为艺术, 让它美起来</u>



# 观察者模式

### **概念:**

**一个目标**物件管理**所有**相依于它的**观察者**物件，并且在它本身的状态改变时**主动**发出通知。这通常透过呼叫各观察者所提供的方法来实现。此种模式通常被用来实现事件处理系统。

分析: 

1). 适用一对多->所以体现了它的作用价值或者说意义

2). 主动发送自己的状态变化->能与观察者分离逻辑, 让其只需要管好自己需要做的事情即可, 懒即为创造

3). 缺点: 需要直接管理一个含所有观察者的集合, 可能会泄露UI实例

# 与订阅者模式的异同

**观察者模式**的角色为观察者(observer)和主题(subject)对象，observer需要观察subject时，需先到subject里面进行注册（subject对象持有observer对象的集合句柄），然后，当subject对象的内部状态发生变化时，把这个变化通知所有的观察者。 

**发布-订阅模式**的角色为发布者(publisher)和订阅者(subscriber)，pub和sub之间没有直接的耦合关系，pub发布一个消息事件(event)，sub订阅感兴趣的消息事件，sub也可以取消订阅。

图见[这](https://www.cnblogs.com/lovesong/p/5272752.html)

分析:
1). 都有事件接受者和发出者, 发出者作为目标主体将状态变化发出, 观察者接收到事件然后处理
2). 两种模式都可以用于松散耦合，改进代码管理和潜在的复用
3). 订阅模式多了一个调度中心, 它才是注册观察者的地方, 所以两者没了依赖, 正应了 中间层就能解耦合的话

# UML类图的基本知识

在UML类图中，常见的有以下几种关系: 

- 泛化（Generalization）: 指的是一个类class继承另外的一个类class, 本身也可新增功能. 符号: 空心三角箭头+实线, 指向父类(寻找基类)
- 实现（Realization）: 指的是一个class类实现interface接口. 符号: 空心三角箭头+虚线, 指向接口(寻找接口定义) 
- 关联（Association）: 体现的是两个类或类与接口之间语义级别的一种强依赖关系(成员变量), 关系比依赖更强、不存在依赖关系的偶然性、关系也不是临时性的，一般是长期性的，而且双方的关系一般是平等的、关联可以是单向、双向的. 符号: 一角箭头+实线(双向时无需箭头), 指向持有者(寻找使用者)
- 聚合（Aggregation）: 是关联关系的一种特例，他体现的是整体与部分、拥有的关系, 此时整体与部分之间是可分离的(可分离只是一种能力, 关系强度仍然比关联强)，他们可以具有各自的生命周期，部分可以属于多个整体对象，也可以为多个整体对象共享. 符号: 空心菱形+实线+一角箭头，指向持有者(寻找使用者)
- 组合（Composition）: 也是关联关系的一种特例，他体现的是一种contains-a的关系，这种关系比聚合更强，也称为强聚合. 他同样体现整体与部分间的关系，但此时整体与部分是不可分的，整体的生命周期结束也就意味着部分的生命周期结束. 符号: 实心菱形+实线+一角箭头，指向持有者(寻找使用者)
- 依赖（Dependency）: 就是一个类A使用到了另一个类B(局部变量、方法的参数或者对静态方法的调用), 使用关系是具有偶然性的、临时性的、非常弱的. 符号: 一角箭头+虚线, 指向被使用者(寻找依赖类)

<u> (泛化 = 实现) > 组合 > 聚合 > 关联 > 依赖。</u>

图见[这](https://www.cnblogs.com/hoojo/p/uml_design.html#top)

